<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Codeblocks</title>
    <link rel="stylesheet" href="gameplay-style.css">
  </head>

  <body>

  <div class="header-bar">
    <button id="btn-back" class="nav-btn">‚Æå Back</button>

    <div class="title" id="title-text">GO TO THE FLOWER!</div>

    <div class="right-controls">
        <button id="lang-toggle-btn" class="lang-btn">EN</button>
        <button id="btn-run" class="nav-btn">‚ñ∂ RUN</button>
    </div>
  </div>


  <canvas id="game"></canvas>

  <button id="btn-reset-manual" class="btn-reset-manual">Restart?</button>

  <div class="bottom-panel">

    <!-- TOOLBAR kiri -->
    <div class="toolbar-area">
      <h3 id="title-blocks">Blocks</h3>
        <div class="toolbar-buttons">

          <div class="toolbar-btn" id="btn-jalan">
            <span class="block-label">ü°±</span>
            <div class="dropup" id="dropup-jalan">
              <div class="drop-item" data-type="jalan" data-dir="up">ü°±</div>
              <div class="drop-item" data-type="jalan" data-dir="right">ü°≤</div>
              <div class="drop-item" data-type="jalan" data-dir="left">ü°∏</div>
              <div class="drop-item" data-type="jalan" data-dir="down">ü°≥</div>
            </div>
          </div>

          <div class="toolbar-btn" id="btn-tembak">
            <span class="block-label">üî´</span>
            <div class="dropup" id="dropup-tembak">
              <div class="drop-item" data-type="tembak">üî´</div>
            </div>
          </div>

          <div class="toolbar-btn" id="btn-loop">
            <span class="block-label">üîÅ</span>
            <div class="dropup" id="dropup-loop">
              <div class="drop-item" data-type="loop" data-dir="default">1</div>
            </div>
          </div>

          <div class="toolbar-btn" id="btn-if-else">
            <span class="block-label">!</span>
            <div class="dropup" id="dropup-if-else">
              <div class="drop-item" data-type="if-else" data-dir="default">1</div>
            </div>
          </div>

          <!-- FUNCTION BLOCK DENGAN TOGGLE DAN DEFINITION BUBBLE -->
          <div class="toolbar-btn" id="btn-function">
            <span class="block-label function-label">{}</span>
            
            <!-- Tombol Toggle Function Definition (di render ulang via JS) -->
            <div class="function-toggle-btn" id="function-toggle-btn-toolbar">‚ñº</div>

            <!-- Function Definition Bubble - Selalu di toolbar, dibuka/ditutup via JS -->
            <div class="function-dropup" id="function-definition-bubble">
              <div class="function-slot-container">
                  <div class="slot function-nested-slot" data-index="0"></div>
                  <div class="slot function-nested-slot" data-index="1"></div>
              </div>
            </div>

            <div class="dropup" id="dropup-function">
              <div class="drop-item" data-type="function" data-dir="default">{}</div>
            </div>
          </div>
          <!-- END FUNCTION BLOCK -->

        </div>
    </div>


    <!-- WORKSPACE kanan - KOSONGKAN DARI SINI -->
  </div>
    
  <!-- WORKSPACE BARU: Pindah ke luar bottom-panel untuk mengontrol stacking secara global -->
  <div class="workspace-area-wrapper">
      <div class="workspace-area">

        <button id="btn-reset-workspace" class="btn-reset-workspace">‚Ü∫ Clear</button>

        <h3 id="title-workspace">Area Kerja</h3>
        <div id="slots" class="workspace-scroll">
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
        </div>
      </div>
  </div>


  <div id="win-overlay" class="win-overlay">
    <div class="win-popup">
      <div class="win-title">üéâ YOU WIN! üéâ</div>
      <div id="honey-reward" class="honey-reward">
        <img src="../Asset/Sprites/Honeycomb.png" class="honey-icon">
        <div class="honey-equal">=</div>
        <span id="honey-number">1</span>
      </div>
      <button class="btn-kembali" id="btn-kembali-win">‚Æå BACK</button>
    </div>
  </div>

  <div id="intro-popup">
    <div class="intro-content">
      <canvas id="intro-bee-canvas" width="64" height="64"></canvas>
      <div class="intro-arrow">ü°≤</div>
      <img src="../Asset/flower-demo.png" class="intro-flower">
    </div>
  </div>

  <script type="module" src="gameplay-script.js"></script>
  </body>
</html>